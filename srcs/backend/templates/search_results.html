{% extends "base.html" %}

{% block title %}Search Results - PartStock{% endblock %}

{% block content %}
<div class="search-results">
    <div class="search-header">
        <h2>Search Results{% if query %} for "{{ query }}"{% endif %}</h2>
        
        <div class="search-box">
            <input 
                type="text" 
                id="searchInput" 
                value="{{ query }}"
                placeholder="Search by SKU..."
                onkeypress="handleSearch(event)"
            >
            <button onclick="performSearch()">Search</button>
        </div>
    </div>
    
    {% if error %}
    <div class="error-message">
        {{ error }}
    </div>
    {% endif %}
    
    {% if products %}
    <div class="results-section">
        <h3>Products ({{ products|length }} found)</h3>
        <div class="results-grid">
            {% for product in products %}
            <div class="result-item">
                <a href="/products/{{ product.id }}">
                    <h4>{{ product.sku }}</h4>
					<p>{{ product.title }}
						{% if product.title_ref %} <b>{{ product.title_ref }}</b>{% endif %}</p>
                    <span class="price">€{{ "%.2f"|format(product.reference_price / 100) }}</span>
                </a>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
    
    {% if units %}
    <div class="results-section">
        <h3>Units ({{ units|length }} found)</h3>
        <div class="results-grid">
            {% for unit in units %}
            <div class="result-item">
                <a href="/units/{{ unit.id }}">
                    <h4>{{ unit.full_reference }}</h4>
                    <p>{{ unit.description }}</p>
                    <span class="price">€{{ "%.2f"|format(unit.selling_price / 100) }}</span>
                    <span class="status {{ unit.status }}">{{ unit.status }}</span>
                </a>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
    
    {% if not products and not units and query %}
    <div class="no-results">
        <h3>No results found</h3>
        <p>No products or units match your search for "{{ query }}".</p>
        <div class="suggestions">
            <h4>Search suggestions:</h4>
            <ul>
                <li>Try searching for just the component code (e.g., "CD", "ME")</li>
                <li>Search for partial SKU numbers (e.g., "1234")</li>
                <li>Use the full reference format (e.g., "CD1234-25A001")</li>
            </ul>
        </div>
    </div>
    {% endif %}
</div>

<script>
    function performSearch() {
        const query = document.getElementById('searchInput').value.trim();
        if (query) {
            window.location.href = `/search?q=${encodeURIComponent(query)}`;
        }
    }
</script>
{% endblock %}
